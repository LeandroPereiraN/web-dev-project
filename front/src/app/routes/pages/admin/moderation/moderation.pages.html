<section class="space-y-8">
  <header class="space-y-1">
    <h1 class="text-3xl font-semibold text-slate-100">Historial de moderación</h1>
    <p class="text-sm text-slate-400">
      Consultá las decisiones tomadas por el equipo administrativo para mantener la plataforma en
      buen estado.
    </p>
  </header>

  @if (errorMessage()) {
  <p
    class="rounded-xl border border-dashed border-red-500/40 bg-red-500/10 px-4 py-3 text-sm text-red-200"
  >
    {{ errorMessage() }}
  </p>
  } @if (loading()) {
  <div class="space-y-4 rounded-3xl border border-slate-800/60 bg-slate-950/40 p-6">
    @for (skeleton of [0, 1, 2, 3]; track $index) {
    <div class="flex flex-col gap-3">
      <p-skeleton width="40%" height="1.2rem"></p-skeleton>
      <p-skeleton width="100%" height="0.9rem"></p-skeleton>
      <p-skeleton width="60%" height="0.9rem"></p-skeleton>
    </div>
    }
  </div>
  } @else if (actions().length) {
  <div class="rounded-3xl border border-slate-800/60 bg-slate-950/40 p-6">
    <p-timeline [value]="actions()" align="alternate" layout="vertical" styleClass="timeline-none">
      <ng-template pTemplate="marker" let-action>
        <span [ngClass]="markerClasses(action)">
          <i class="pi pi-shield"></i>
        </span>
      </ng-template>
      <ng-template pTemplate="opposite" let-action>
        <span class="text-xs uppercase tracking-wide text-slate-500">
          {{ action.createdAt | date : 'dd MMM yyyy HH:mm' }}
        </span>
      </ng-template>
      <ng-template pTemplate="content" let-action>
        <div
          class="rounded-2xl border border-slate-800/60 bg-slate-950/80 p-5 shadow-lg shadow-slate-950/40"
        >
          <div class="flex flex-wrap items-start justify-between gap-3">
            <div>
              <h3 class="text-lg font-semibold text-slate-100">{{ resolveActionLabel(action) }}</h3>
              <p class="text-xs text-slate-500">{{ resolveAdminLabel(action) }}</p>
            </div>
            <p-tag
              [value]="resolveTarget(action)"
              [severity]="resolveActionSeverity(action)"
              styleClass="text-xs"
            ></p-tag>
          </div>

          <p class="mt-3 text-sm text-slate-300">{{ action.justification }}</p>

          @if (action.internalNotes) {
          <div class="mt-3 rounded-xl bg-slate-900/70 px-4 py-3 text-xs text-slate-400">
            <p class="mb-1 font-semibold text-slate-300">Notas internas</p>
            <p class="whitespace-pre-line">{{ action.internalNotes }}</p>
          </div>
          }
        </div>
      </ng-template>
    </p-timeline>

    <div class="mt-6">
      <p-paginator
        [rows]="pageSize()"
        [first]="(page() - 1) * pageSize()"
        [totalRecords]="total()"
        [rowsPerPageOptions]="[6, 8, 12]"
        (onPageChange)="onPageChange($event)"
        styleClass="rounded-full border border-slate-800/60 bg-slate-900/50"
      ></p-paginator>
    </div>
  </div>
  } @else {
  <div
    class="flex flex-col items-center gap-4 rounded-3xl border border-dashed border-slate-800/60 bg-slate-950/40 px-8 py-16 text-center text-slate-400"
  >
    <i class="pi pi-history text-3xl text-slate-500"></i>
    <p class="max-w-md text-sm">
      Aún no se registraron acciones de moderación recientes. Cuando el equipo actúe, verás el
      historial completo aquí.
    </p>
  </div>
  }
</section>
